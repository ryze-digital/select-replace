var e={d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{P:()=>n});class i{constructor(e,t){this._defaultOptions=e,this._options=t,this._eventListeners=new Map}get options(){return{...this._defaultOptions,...this._options}}_isNodeList(e){return NodeList.prototype.isPrototypeOf(e)}_attachEvent(e,t,i){this._eventListeners.has(e)?this._eventListeners.get(e).push({[t]:i}):this._eventListeners.set(e,[{[t]:i}]),e.addEventListener(t,i)}_detachEvent(e,t,i,s){e.removeEventListener(t,i),this._eventListeners.get(e).splice(s,1)}_detachEvents(e,t){this._eventListeners.get(e).forEach(((i,s)=>{if(""===t)this._detachEvent(e,Object.keys(i)[0],Object.values(i)[0],s);else{const o=i[t];"function"==typeof o&&this._detachEvent(e,t,o,s)}})),0===this._eventListeners.get(e).length&&this._eventListeners.delete(e)}emitEvent(e="",t={},i=this.options.el){const s=new CustomEvent(e,{detail:t});i.dispatchEvent(s)}on(e,t,i){this._isNodeList(e)?e.forEach((e=>{this._attachEvent(e,t,i)})):this._attachEvent(e,t,i)}off(e,t=""){this._isNodeList(e)?e.forEach((e=>{this._detachEvents(e,t)})):this._detachEvents(e,t)}offAll(){this._eventListeners.forEach(((e,t)=>{this._detachEvents(t,"")}))}}class s{#e;#t=null;#i=!1;#s=!1;#o;constructor(e,t,i){this.options=e,this.#e=t,this.#o=i}get optionListCreated(){return this.#i}get optionList(){return this.#t}get visible(){return this.#s}createOptionList(){this.#t=document.createElement("div"),Object.assign(this.#t,{role:"listbox",classList:[this.options.classes.optionList],ariaExpanded:"false",style:{display:"none"}}),this.#t.addEventListener("click",this.#o),this.#t.dataset.id=this.options.el.id,this.#i=!0,this.options.optionList.appendTo.append(this.#t)}syncOptions(){this.#t.innerHTML="",this.options.el.querySelectorAll("option").forEach((e=>{const t=document.createElement("div");let i="false";e.selected&&(i="true"),Object.assign(t,{role:"option",textContent:e.text,ariaSelected:i}),t.dataset.value=e.value,this.#t.append(t)}))}show(){const{top:e,left:t,width:i}=this.#n();Object.assign(this.#t.style,{top:e,left:t,display:"block"}),!0===this.options.optionList.calcWidth&&(this.#t.style.width=i),this.#t.ariaExpanded="true",this.#s=!0,document.addEventListener("click",this.#l)}hide(){this.#t.style.display="none",this.#t.ariaExpanded="false",this.#s=!1,document.removeEventListener("click",this.#l)}#n(){const e=this.#e.getBoundingClientRect(),t=this.options.optionList.appendTo.getBoundingClientRect();return{top:`${e.top-t.top+e.height}px`,left:e.left-t.left+"px",width:`${e.width}px`}}#l=e=>{null===e.composedPath()[0].closest(`.${this.options.classes.optionList}`)&&!0===this.#s&&this.hide()}}class o{#e;#o;#c;#h;constructor(e,t,i){this.options=e,this.#e=t,this.#c=i}set placeholder(e){this.#h.textContent=e}createPlaceholder(){this.#h=document.createElement("span"),this.#h.classList.add(this.options.classes.placeholder),!0===this.options.el.multiple?this.refreshSelectedCount(this.#c):this.placeholder=this.#a(),this.#e.append(this.#h)}refreshSelectedCount(e){this.placeholder=e>0?`${e} ${this.options.i18n.selectedOptions[this.options.i18n.use]}`:this.options.el.dataset.placeholder}#a(){let e=this.options.el.querySelector("option").textContent;return this.#c>0&&(e=this.options.el.querySelector(":checked").textContent),e}}class n extends i{#e=null;#r;#d;#p;constructor(e={}){super({el:document.querySelector("select"),optionList:{calcWidth:!0,appendTo:document.body},classes:{fakeSelect:"select-replace",placeholder:"placeholder",optionList:"option-list"},i18n:{languages:["en","de"],selectedOptions:{en:"selected",de:"ausgewÃ¤hlt"},use:"en"}},e),!0===this.options.el.multiple&&void 0===this.options.el.dataset.placeholder&&console.error(`Select with id="${this.options.el.id}" is missing data-placeholder`),this.#u()}init(){this.#v(),this.#r=new s(this.options,this.#e,this.#L),this.#d=new o(this.options,this.#e,this.selectedCount),this.#d.createPlaceholder(),this.#p=new MutationObserver(this.#f)}update(){!0===this.#r.optionListCreated&&this.#r.syncOptions(),!0===this.options.el.multiple?this.#d.refreshSelectedCount(this.selectedCount):this.#d.placeholder=this.options.el.querySelector("option:checked").textContent}get selectedCount(){return this.options.el.querySelectorAll("option:checked").length}#u(){this.options.i18n.languages.includes(document.documentElement.lang)&&(this.options.i18n.use=document.documentElement.lang)}#v(){this.#e=document.createElement("div"),this.#e.classList.add(this.options.classes.fakeSelect),this.#e.addEventListener("click",this.#S),this.options.el.after(this.#e),this.options.el.style.display="none"}#S=e=>{e.stopPropagation(),!1===this.#r.optionListCreated&&(this.#r.createOptionList(),this.#r.syncOptions(),this.#p.observe(this.options.el,{attributes:!0,childList:!0,subtree:!0})),!0===this.#r.visible?this.#r.hide():this.#r.show()};#L=e=>{const t=e.target.closest("[data-value]");if(null===t)return;const i=[].slice.call(this.#r.optionList.children).indexOf(t),s=this.options.el.querySelector(`option:nth-child(${i+1})`);!1===this.options.el.multiple?(this.#g(),this.#k(s,t),this.#r.hide(),this.#d.placeholder=e.target.textContent):(this.#C(s,t),this.#d.refreshSelectedCount(this.selectedCount)),this.options.el.dispatchEvent(new Event("change"))};#g(){const e=this.options.el.querySelector("option:checked"),t=this.#r.optionList.querySelector('[aria-selected="true"]');null!==e&&(e.selected=!1),null!==t&&(t.ariaSelected="false")}#k(e,t){e.selected=!0,t.ariaSelected="true"}#C(e,t){e.selected=!e.selected,t.ariaSelected="true"===t.ariaSelected?"false":"true"}#f=()=>{this.#r.syncOptions(),!0===this.options.el.multiple&&this.#d.refreshSelectedCount(this.selectedCount)}}var l=t.P;export{l as SelectReplace};