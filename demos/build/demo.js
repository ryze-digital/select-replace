var e={d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{P:()=>l});class i{constructor(e,t){this._defaultOptions=e,this._options=t,this._eventListeners=new Map}get options(){return{...this._defaultOptions,...this._options}}_isNodeList(e){return NodeList.prototype.isPrototypeOf(e)}_attachEvent(e,t,i){this._eventListeners.has(e)?this._eventListeners.get(e).push({[t]:i}):this._eventListeners.set(e,[{[t]:i}]),e.addEventListener(t,i)}_detachEvent(e,t,i,s){e.removeEventListener(t,i),this._eventListeners.get(e).splice(s,1)}_detachEvents(e,t){this._eventListeners.get(e).forEach(((i,s)=>{if(""===t)this._detachEvent(e,Object.keys(i)[0],Object.values(i)[0],s);else{const o=i[t];"function"==typeof o&&this._detachEvent(e,t,o,s)}})),0===this._eventListeners.get(e).length&&this._eventListeners.delete(e)}emitEvent(e="",t={},i=this.options.el){const s=new CustomEvent(e,{detail:t});i.dispatchEvent(s)}on(e,t,i){this._isNodeList(e)?e.forEach((e=>{this._attachEvent(e,t,i)})):this._attachEvent(e,t,i)}off(e,t=""){this._isNodeList(e)?e.forEach((e=>{this._detachEvents(e,t)})):this._detachEvents(e,t)}offAll(){this._eventListeners.forEach(((e,t)=>{this._detachEvents(t,"")}))}}class s{#e;#t=null;#i=!1;#s=!1;#o;#n;constructor(e,t,i,s){this.options=e,this.#e=t,this.#o=i,this.#n=s}get optionListCreated(){return this.#i}get optionList(){return this.#t}get visible(){return this.#s}createOptionList(){this.#t=document.createElement("div"),Object.assign(this.#t,{role:"listbox",classList:[this.options.classes.optionList],ariaExpanded:"false",style:{display:"none"}}),this.#t.addEventListener("click",this.#o),this.#t.dataset.id=this.options.el.id,this.#i=!0,this.options.optionList.appendTo.append(this.#t)}syncOptions(){this.#t.innerHTML="",this.options.el.querySelectorAll("option").forEach((e=>{const t=document.createElement("div");let i="false";e.selected&&(i="true"),Object.assign(t,{role:"option",textContent:e.text,ariaSelected:i}),t.dataset.value=e.value,this.#t.append(t)}))}show(){!1===this.optionListCreated&&(this.createOptionList(),this.syncOptions(),this.#n.observe(this.options.el,{attributes:!0,childList:!0,subtree:!0}));const{top:e,left:t,width:i}=this.#l();Object.assign(this.#t.style,{top:e,left:t,display:"block"}),!0===this.options.optionList.calcWidth&&(this.#t.style.width=i),this.#t.ariaExpanded="true",this.#s=!0,document.addEventListener("click",this.#r)}hide(){this.#t.style.display="none",this.#t.ariaExpanded="false",this.#s=!1,document.removeEventListener("click",this.#r)}#l(){const e=this.#e.getBoundingClientRect(),t=this.options.optionList.appendTo.getBoundingClientRect();return{top:`${e.top-t.top+e.height}px`,left:e.left-t.left+"px",width:`${e.width}px`}}#r=e=>{null===e.composedPath()[0].closest(`.${this.options.classes.optionList}`)&&!0===this.#s&&this.hide()}}class o{#e;#o;#h;#c;constructor(e,t,i){this.options=e,this.#e=t,this.#h=i}set placeholder(e){this.#c.textContent=e}createPlaceholder(){this.#c=document.createElement("span"),this.#c.classList.add(this.options.classes.placeholder),!0===this.options.el.multiple?this.refreshSelectedCount(this.#h):this.placeholder=this.#a(),this.#e.append(this.#c)}refreshSelectedCount(e){this.placeholder=e>0?`${e} ${this.options.i18n.selectedOptions[this.options.i18n.use]}`:this.options.el.dataset.placeholder}#a(){let e=this.options.el.querySelector("option").textContent;return this.#h>0&&(e=this.options.el.querySelector(":checked").textContent),e}}class n{#e;#d;constructor(e,t,i,s){this.options=e,this.#e=t,this.#d=i,this.options.el.addEventListener("focusin",this.#p),this.options.el.addEventListener("focusout",this.#u),this.options.el.addEventListener("change",s)}#p=()=>{this.#e.classList.add(this.options.classes.focussed),this.#d.show(),this.options.el.addEventListener("keydown",this.#v)};#u=()=>{this.#e.classList.remove(this.options.classes.focussed),this.#d.hide(),this.options.el.removeEventListener("keydown",this.#v)};#v=e=>{switch(e.key){case"Escape":this.#u();break;case"Enter":e.preventDefault(),this.#u()}}}class l extends i{#e=null;#d;#L;#S;#n;constructor(e={}){super({el:document.querySelector("select"),optionList:{calcWidth:!0,appendTo:document.body},classes:{fakeSelect:"select-replace",placeholder:"placeholder",optionList:"option-list",hideSelect:"visually-hidden",focussed:"has-focus"},i18n:{languages:["en","de"],selectedOptions:{en:"selected",de:"ausgewÃ¤hlt"},use:"en"}},e),this.isMultiple&&void 0===this.options.el.dataset.placeholder&&console.error(`Select with id="${this.options.el.id}" is missing data-placeholder`),this.#f()}init(){this.#k(),this.#n=new MutationObserver(this.#g),this.#d=new s(this.options,this.#e,this.#C,this.#n),this.#L=new o(this.options,this.#e,this.selectedCount),this.#L.createPlaceholder(),this.#S=new n(this.options,this.#e,this.#d,this.#E)}update(){!0===this.#d.optionListCreated&&this.#d.syncOptions(),this.isMultiple?this.#L.refreshSelectedCount(this.selectedCount):this.#L.placeholder=this.options.el.querySelector("option:checked").textContent}get selectedCount(){return this.options.el.querySelectorAll("option:checked").length}get isMultiple(){return this.options.el.multiple}#f(){this.options.i18n.languages.includes(document.documentElement.lang)&&(this.options.i18n.use=document.documentElement.lang)}#k(){this.#e=document.createElement("div"),this.#e.classList.add(this.options.classes.fakeSelect),this.#e.addEventListener("click",this.#P),this.options.el.after(this.#e),this.options.el.classList.add(this.options.classes.hideSelect)}#P=e=>{e.stopPropagation(),!0===this.#d.visible?this.#d.hide():this.#d.show()};#C=e=>{const t=e.target.closest("[data-value]");if(null===t)return;const i=[].slice.call(this.#d.optionList.children).indexOf(t),s=this.options.el.querySelector(`option:nth-child(${i+1})`);!1===this.isMultiple?(this.#y(),this.#m(s,t),this.#d.hide(),this.#L.placeholder=e.target.textContent):(this.#b(s,t),this.#L.refreshSelectedCount(this.selectedCount)),this.options.el.dispatchEvent(new Event("change"))};#E=()=>{const e=this.options.el.querySelectorAll("option:checked");this.#d.optionList.querySelectorAll('[aria-selected="true"]').forEach((e=>{this.#y(null,e)})),e.forEach((e=>{const t=this.#d.optionList.querySelector(`[data-value="${e.value}"]`);this.#m(null,t)})),this.isMultiple?this.#L.refreshSelectedCount(e.length):this.#L.placeholder=e[0].textContent};#y(e=this.options.el.querySelector("option:checked"),t=this.#d.optionList.querySelector('[aria-selected="true"]')){null!==e&&(e.selected=!1),null!==t&&(t.ariaSelected="false")}#m(e,t){null!==e&&(e.selected=!0),null!==t&&(t.ariaSelected="true")}#b(e,t){null!==e&&(e.selected=!e.selected),null!==t&&(t.ariaSelected="true"===t.ariaSelected?"false":"true")}#g=()=>{this.#d.syncOptions(),this.isMultiple&&this.#L.refreshSelectedCount(this.selectedCount)}}var r=t.P;export{r as SelectReplace};